From d496b7c619fe9e7e64cdc82bdabb2aa345c9ba03 Mon Sep 17 00:00:00 2001
From: Jozef Mlich <jmlich83@gmail.com>
Date: Mon, 26 Jul 2021 20:50:14 +0200
Subject: [PATCH] setlocale path

---
 setlocale/main.cpp    | 2 +-
 src/localeconfig.cpp  | 3 ++-
 3 files changed, 7 insertions(+), 3 deletions(-)

diff --git a/setlocale/main.cpp b/setlocale/main.cpp
index fabadf5..fb240da 100644
--- a/setlocale/main.cpp
+++ b/setlocale/main.cpp
@@ -78,7 +78,7 @@ static bool writeLocale(QString &configPath, QString &locale)
 {
     QFile localeConfig(configPath);
     if (!ensureDirectory(configPath)) {
-        qWarning() << "Unable to create directory for locale configuration file";
+        qWarning() << "Unable to create directory for locale configuration file" << configPath;
         return false;
     }
 
diff --git a/src/localeconfig.cpp b/src/localeconfig.cpp
index ffb59ab..886d2fc 100644
--- a/src/localeconfig.cpp
+++ b/src/localeconfig.cpp
@@ -31,6 +31,7 @@
  * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE."
  */
 
+#include <QStandardPaths>
 #include <QDebug>
 
 #include "localeconfig.h"
@@ -41,7 +42,7 @@
 QString localeConfigPath()
 {
     // User-wide locale config
-    return QString("/home/.system/var/lib/environment/%1/locale.conf").arg(getuid());
+    return QString("%1/.config/locale.conf").arg(QStandardPaths::writableLocation(QStandardPaths::HomeLocation));
 }
 
 QString systemLocaleConfigPath()
-- 
2.32.0

