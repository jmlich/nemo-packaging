# Maintainer: Felix Yan <felixonmars@archlinux.org>
# Contributor: Andrea Scarpino <andrea@archlinux.org>

pkgname=qt6-sensors-sensorfw
_basever=5.15.9
pkgver=5.15.9
pkgrel=1
_commit=391c710b88865a3e0311b61d93fcdbbfd6996d46
arch=('x86_64' 'aarch64')
url='https://www.qt.io'
license=('GPL3' 'LGPL3' 'FDL' 'custom')
pkgdesc='SensorFW plugin for qt6-sensors'
depends=('sensorfw' 'qt6-sensors')
makedepends=('qt6-declarative' 'git')
optdepends=('qt6-declarative: QML bindings')
groups=('qt' 'qt6')
source=("git+https://invent.kde.org/qt/qt/qtsensors#commit=$_commit"
    '2001-convert-sensorfw-plugin-into-a-standalone-plugin.patch'
)
sha256sums=('SKIP'
    'c25263818273153c5de14b075e00283b364ddbc286c4d18901922ebed21b1949'
)

prepare() {
    cd qtsensors
    patch -p1 --input="${srcdir}/2001-convert-sensorfw-plugin-into-a-standalone-plugin.patch"
}

build() {
  cd qtsensors/src/plugins/sensors/sensorfw
  qmake6
  make
}

package() {
  cd qtsensors/src/plugins/sensors/sensorfw
  make -j 1 INSTALL_ROOT="${pkgdir}" install
}
